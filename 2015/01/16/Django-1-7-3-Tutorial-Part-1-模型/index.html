
 <!DOCTYPE HTML>
<html >
<head>
  <meta charset="UTF-8">
  
    <title>Django-1.7.3-Tutorial-Part-1-模型 | Tim Chan&#39;s Blog!</title>
    <meta name="viewport" content="width=device-width, initial-scale=1,user-scalable=no">
    
    <meta name="author" content="Tim Chan">
    
    <meta name="description" content="创建你的第一个Django app-Part 1

让我们从简单的例子开始吧。
通过这个教程，我们将快速学习投票(poll)应用的创建。
环境：windows 8 32 bits + Python 2.7.5 + Django 1.7.3
它包含两个部分：
一个供人们查看和进行投票的公开的站点。
一">
    
    
    
    
    <link rel="alternative" href="/atom.xml" title="Tim Chan&#39;s Blog!" type="application/atom+xml">
    
    
    <link rel="icon" href="/img/favicon.ico">
    
    
    <link rel="apple-touch-icon" href="/img/jacman.jpg">
    <link rel="apple-touch-icon-precomposed" href="/img/jacman.jpg">
    
    <link rel="stylesheet" href="/css/style.css" type="text/css">

</head>

  <body>
    <header>
      <div>
		
			<div id="imglogo">
				<a href="/"><img src="/img/logo.png" alt="Tim Chan&#39;s Blog!" title="Tim Chan&#39;s Blog!"/></a>
			</div>
			
			<div id="textlogo">
				<h1 class="site-name"><a href="/" title="Tim Chan&#39;s Blog!">Tim Chan&#39;s Blog!</a></h1>
				<h2 class="blog-motto">记录生活点滴！</h2>
			</div>
			<div class="navbar"><a class="navbutton navmobile" href="#" title="Menu">
			</a></div>
			<nav class="animated">
				<ul>
					<ul>
					 
						<li><a href="/">首页</a></li>
					
						<li><a href="/archives">归档</a></li>
					
						<li><a href="/about">关于我</a></li>
					
						<li><a href="https://pomotodo.com/app/">ToDo</a></li>
					
					<li>
 					
					<form class="search" action="//google.com/search" method="get" accept-charset="utf-8">
						<label>Search</label>
						<input type="search" id="search" name="q" autocomplete="off" maxlength="20" placeholder="Search" />
						<input type="hidden" name="q" value="site:tim4chan.com">
					</form>
					
					</li>
				</ul>
			</nav>			
</div>
    </header>
    <div id="container">
      <div id="main" class="post" itemscope itemprop="blogPost">
	<article itemprop="articleBody"> 
		<header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2015/01/16/Django-1-7-3-Tutorial-Part-1-模型/" title="Django-1.7.3-Tutorial-Part-1-模型" itemprop="url">Django-1.7.3-Tutorial-Part-1-模型</a>
  </h1>
  <p class="article-author">By
       
		<a href="http://tim4chan.com/about" title="Tim Chan" target="_blank" itemprop="author">Tim Chan</a>
		
  <p class="article-time">
    <time datetime="2015-01-16T02:46:52.000Z" itemprop="datePublished"> Published Jan 16 2015</time>
    
  </p>
</header>
	<div class="article-content">
		
		
		<div id="toc" class="toc-article">
			<strong class="toc-title">Contents</strong>
		
			<ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#创建你的第一个Django_app-Part_1"><span class="toc-number">1.</span> <span class="toc-text">创建你的第一个Django app-Part 1</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#创建项目"><span class="toc-number">1.1.</span> <span class="toc-text">创建项目</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#数据库配置"><span class="toc-number">1.2.</span> <span class="toc-text">数据库配置</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#发布到服务器"><span class="toc-number">1.3.</span> <span class="toc-text">发布到服务器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#创建模型(models)"><span class="toc-number">1.4.</span> <span class="toc-text">创建模型(models)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#激活模型(Activating_models)"><span class="toc-number">1.5.</span> <span class="toc-text">激活模型(Activating models)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#玩转API"><span class="toc-number">1.6.</span> <span class="toc-text">玩转API</span></a></li></ol></li></ol>
		
		</div>
		
		<h1 id="创建你的第一个Django_app-Part_1">创建你的第一个Django app-Part 1</h1>
<ul>
<li>让我们从简单的例子开始吧。</li>
<li>通过这个教程，我们将快速学习投票(poll)应用的创建。</li>
<li>环境：windows 8 32 bits + Python 2.7.5 + Django 1.7.3</li>
<li>它包含两个部分：<ul>
<li>一个供人们查看和进行投票的公开的站点。</li>
<li>一个管理员站点，可以让你进行添加，修改和查询投票。</li>
</ul>
</li>
<li>我们假设你已经装好了Django.你可以通过以下命令查看你安装的版本。</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ python -c <span class="string">"import django; print(django.get_version())"</span></div></pre></td></tr></table></figure>

<ul>
<li>如果你成功安装了Django，你就会看到版本号，否则，你就会得到一个错误信息：”No module named django”.</li>
<li>我的Django信息如下：<br><img src="/img/Django-1-7-3-tutorial/get_version.png" alt=""></li>
</ul>
<h2 id="创建项目">创建项目</h2>
<ul>
<li>如果你是第一次使用Django，那么你应该注意一些初始化的设置。也就是说，你需要一些自生成的代码来构建一个Django项目，包括Django实例的设置文件，譬如数据库配置文件，Django指定选项和应用指定的设置。</li>
<li>从命令行中切换到你想把项目存储的目录，然后输入以下命令:</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ django-admin.py startproject mysite</div></pre></td></tr></table></figure>

<ul>
<li>在当前目录下就会生成一个mysite的目录。如果没有，请查看<a href="https://docs.djangoproject.com/en/1.7/faq/troubleshooting/#troubleshooting-django-admin-py" target="_blank" rel="external">问题反馈</a></li>
</ul>
<blockquote>
<p><strong>笔记</strong><br>请注意命名，不能和Python或者Django组件中的关键字重名，特别的，你不能使用django或者test。</p>
</blockquote>
<ul>
<li>通过startproject命令创建的目录如下：<br><img src="/img/Django-1-7-3-tutorial/dir-startproject.png" alt=""></li>
</ul>
<blockquote>
<p><strong>和你建的目录不同？</strong><br>默认项目布局最近有所改变。如果你看到一个’flat’布局(里面没有mysite/目录)，你可能使用的Django和本教程的版本不同。请移步。</p>
</blockquote>
<ul>
<li>目录路径解释：<ul>
<li>外层mysite/：你的项目的根目录。它的名字可以随意更改。</li>
<li>manage.py文件：它是一个和Django进行多样化交互的命令行工具。你可以从以下链接查看详细内容<a href="https://docs.djangoproject.com/en/1.7/ref/django-admin/" target="_blank" rel="external">django-admin.py and manage.py</a></li>
<li>内层mysite/：它是项目的真正的python包。名字不可随意更改，因为它是在其他地方可供导入的(例如：mysite.urls)</li>
<li>mysite/<strong>init</strong>.py：一个空文件，它的作用是标注自己是一个python包。</li>
<li>mysite/settings.py：Django项目的设置或配置。详细可查看<a href="https://docs.djangoproject.com/en/1.7/topics/settings/" target="_blank" rel="external">Django settings</a></li>
<li>mysite/urls.py：对Django项目的URL声明，就像是你的Django网站的目录列表。详细可查看<a href="https://docs.djangoproject.com/en/1.7/topics/http/urls/" target="_blank" rel="external">URL dispatcher</a></li>
<li>mysite/wsgi.py：它是配置WSGI服务器的入口点。详细可见：<a href="https://docs.djangoproject.com/en/1.7/howto/deployment/wsgi/" target="_blank" rel="external">How to deploy with WSGI</a></li>
</ul>
</li>
</ul>
<h2 id="数据库配置">数据库配置</h2>
<ul>
<li>现在，编辑mysite/settings.py文件。它是一个普通的Python模块，用模块级变量表示Django设置。</li>
<li>默认情况下，配置是用SQLite。如果你不熟悉数据库，或者你只想玩玩Django,这是最快捷的选择。SQLite包含在Python中，所以不需要你安装。</li>
<li><p>如果你想用其他数据库，安装相应<a href="https://docs.djangoproject.com/en/1.7/topics/install/#database-installation" target="_blank" rel="external">数据库绑定</a>,然后修改DATABASES中的默认选项来匹配你的数据库连接设置：</p>
<ul>
<li><strong>ENGINE</strong>-数据库引擎，SQLite(默认)：<strong>‘django.db.backends.sqlite3’</strong>;postgresql：<strong>‘django.db.backends.postgresql_psycopg2’</strong>；mysql：<strong>‘django.db.backends.mysql’</strong>；Oracle： <strong>‘django.db.backends.oracle’</strong>，或其他。</li>
<li><strong>NAME</strong>-数据库名称。如果你用SQLite,那么他是电脑上的一个文件，这样的话，<strong>NAME</strong>应该是一个绝对路径，包括文件名。默认值是<strong>os.path.join(BASE_DIR, ‘db.sqlite3’)</strong>，它是存储在项目路径下的文件。</li>
</ul>
</li>
<li><p>如果你不用SQLite，那么你需要添加<strong>USER</strong>,<strong>PASSWORD</strong>,<strong>HOST</strong>。详细可见：<a href="https://docs.djangoproject.com/en/1.7/ref/settings/#std:setting-DATABASES" target="_blank" rel="external">DATABASES</a>。</p>
</li>
</ul>
<blockquote>
<p><strong>笔记</strong><br>如果你在使用PostgreSQL或者MySQL，你必须要创建好数据库。通过命令<strong>CREATE DATABASE database_name;</strong>。<br>如果你在使用SQLite,那么它会自动创建，必须手动创建。</p>
</blockquote>
<ul>
<li>当你在编辑mysite/settings.py时，请把<strong>TIME_ZONE</strong>设置为自己的时区。</li>
<li>另外，文件开头的<strong>INSTALLED_APPS</strong>配置，它Django实例中被激活的Django应用的名字。Apps可以被多个项目使用，你可以把Apps打包和发布给其他项目使用。</li>
<li><p>默认情况下，<strong>INSTALLED_APPS</strong>配置包含Django中的apps，如下：</p>
<ul>
<li><strong>django.contrib.admin</strong>-管理员站点，你在Part2中会用到。</li>
<li><strong>django.contrib.auth</strong>-认证系统</li>
<li><strong>django.contrib.contenttypes</strong>-一个内容类型的框架</li>
<li><strong>django.contrib.sessions</strong>-session框架</li>
<li><strong>django.contrib.messages</strong>-messaging框架</li>
<li><strong>django.contrib.staticfiles</strong>-管理静态文件的框架</li>
</ul>
</li>
<li><p>这些apps默认添加的，你可以根据自己需求修改。</p>
</li>
<li>这些apps中可能要用到数据库表，所以，我们应该先要在数据库中创建表，然后再使用。命令如下：</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ python manage.py migrate</div></pre></td></tr></table></figure>

<ul>
<li><strong>migrate</strong>命令会查看<strong>INSTALLED_APPS</strong>配置，然后根据<strong>mysite/settings.py</strong>文件创建一些需要的数据库表，并把数据库迁移到相应的应用中。n你可以查看信息：运行数据库客户端，在命令行中输入\dt (PostgreSQL), SHOW TABLES; (MySQL), or .schema (SQLite)。</li>
</ul>
<h2 id="发布到服务器">发布到服务器</h2>
<ul>
<li>验证你的项目是否可运行，在外层mysite目录下，运行一下命令：</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ python manage.py runserver</div></pre></td></tr></table></figure>

<ul>
<li>你可以看到以下输出(我的版本如下)：</li>
</ul>
<figure class="highlight echo"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">January <span class="number">16</span>, <span class="number">2015</span> - <span class="number">14</span>:<span class="number">18</span>:<span class="number">47</span></div><div class="line">Django <span class="built_in">version</span> <span class="number">1.7</span><span class="number">.3</span>, <span class="keyword">using</span> settings <span class="string">'mysite.settings'</span></div><div class="line">Starting development server <span class="keyword">at</span> <span class="keyword">http</span>://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">8000</span>/</div><div class="line">Quit <span class="operator">the</span> server <span class="operator">with</span> CTRL-BREAK.</div></pre></td></tr></table></figure>

<ul>
<li>你已经把项目成功发布到服务器上了，它是一个用纯python实现的轻量级的Web server。它已经被包含到Django当中，方便我们进行快速的开发。</li>
<li>它不可以用于商用，因为能力有限。我们是开发框架而不是服务器。</li>
<li>现在打开浏览器，输入”127.0.0.1:8000/“，你就可以访问到你的项目页面了。效果如下：<br><img src="/img/Django-1-7-3-tutorial/worked.png" alt=""></li>
</ul>
<blockquote>
<p><strong>修改端口</strong><br>默认端口是8000，如果你想修改，可以按如下格式发布项目</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ python mange.py runserver <span class="number">8080</span></div></pre></td></tr></table></figure>

<blockquote>
<p>如果你想修改服务器的IP，如下格式：</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ python manage.py runserver <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span>:<span class="number">8000</span></div></pre></td></tr></table></figure>


<blockquote>
<p>详细文档参考<a href="https://docs.djangoproject.com/en/1.7/ref/django-admin/#django-admin-runserver" target="_blank" rel="external">runserver</a></p>
<p>服务器自动加载，不用重新发布项目。</p>
</blockquote>
<h2 id="创建模型(models)">创建模型(models)</h2>
<ul>
<li>现在你项目的基本环境已经搭建好，你可以开始做事了。</li>
<li><p>在Django中创建的app都有相同的目录结构，但是Django已经用过工具自动生成了，而不必你操心，你只要专注于写代码就好了。</p>
<blockquote>
<p>Projects VS apps<br>项目和app之间有什么不同呢？一个app表示网站程序中的一个功能，譬如，一个网路博客系统，一个公开记录或公共投票的数据库应用。而一个项目(project)往往是app的集合，几个app组成一个project，另外，一个app可以被多个项目包含。</p>
</blockquote>
</li>
<li><p>如果你的python环境已经配置好，那么你的app可以在任何地方创建。这里我们把polls应用创建在manage.py的旁边，所以，它可以被当成自己的顶级模块导入，而不是mysite的子模块。</p>
</li>
<li>创建app,请到manage.py所在目录下，执行命令：</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ python manage.py startapp polls</div></pre></td></tr></table></figure>

<ul>
<li>创建了一个polls目录，结构如下：<br><img src="/img/Django-1-7-3-tutorial/dir-polls.png" alt=""></li>
<li>这个目录包含polls应用。</li>
<li>通过Django写数据库网页应用的第一步是定义自己的模块(models)-主要的是，你的数据库布局，加上额外的元数据。</li>
</ul>
<blockquote>
<p>哲学<br>一个模型是一个独立的，明确的数据资源。它包含主要的字段和你存储的数据的行为。Django遵循<a href="https://docs.djangoproject.com/en/1.7/misc/design-philosophies/#dry" target="_blank" rel="external">DRY原则</a>。目的是从一个地方定义和导出数据。<br>还包括迁移，不像Ruby On Rails，例如，模型中的数据可以全部迁移，但它只不过是Django中的一个历史记录，可以随时回滚到当前适应的模型。</p>
</blockquote>
<ul>
<li>在简单的投票(polls)应用中，我们创建2个模型：<strong>Question</strong>和<strong>Choice</strong>。<strong>Question</strong>有一个问题和发表日期。<strong>Choice</strong>有两个域：选择文本和投票计数器。每一个<strong>Choice</strong>关联一个<strong>Question</strong>。</li>
<li>这些概念都能通过简单的Python类实现。编辑<strong>polls/models.py</strong>文件，如下：</li>
<li><font color="green">polls/models.py</font>

</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="keyword">from</span> django.db <span class="keyword">import</span> models</div><div class="line"></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Question</span><span class="params">(models.Model)</span>:</span></div><div class="line">    question_text = models.CharField(max_length=<span class="number">200</span>)</div><div class="line">    pub_date = models.DateTimeField(<span class="string">'date published'</span>)</div><div class="line"></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Choice</span><span class="params">(models.Model)</span>:</span></div><div class="line">    question = models.ForeignKey(Question)</div><div class="line">    choice_text = models.CharField(max_length=<span class="number">200</span>)</div><div class="line">    votes = models.IntegerField(default=<span class="number">0</span>)</div></pre></td></tr></table></figure>

<ul>
<li>代码非常简单明了。每个<strong>模型</strong>都是继承类<strong><a href="https://docs.djangoproject.com/en/1.7/ref/models/instances/#django.db.models.Model" target="_blank" rel="external">django.db.models.Model</a></strong>。每个<strong>模型</strong>都有一些类变量，其中每个变量都代表数据库中的一个<strong>字段</strong>。</li>
<li>每个<strong>字段</strong>都是一个<strong>字段<a href="https://docs.djangoproject.com/en/1.7/ref/models/fields/#django.db.models.Field" target="_blank" rel="external">(Field)</a>类</strong>的实例—譬如，<a href="https://docs.djangoproject.com/en/1.7/ref/models/fields/#django.db.models.CharField" target="_blank" rel="external">CharField</a>代表字符域，<a href="https://docs.djangoproject.com/en/1.7/ref/models/fields/#django.db.models.DateTimeField" target="_blank" rel="external">DateTimeField</a>代表数据库实时间。这样Django就知道每个字段是什么类型的。</li>
<li>每个域实例的名字(譬如<strong>question_text</strong>或者<strong>pub_date</strong>)就是字段名称，它是机器能够识别的形式。字段的值会用python代码表示，数据库就会把字段名称当成一个列名。</li>
<li>你还可以为每个字段起一个易于让人读懂的名字。在Django中是支持的，而且也可以记录到文档中。如果你美誉定义这个名字，那么Django就会用机器识别的名字。例如，我们只为<strong>Question.pub_date</strong>定义一个易于让人都懂的名字。对于模型中的其他字段，机读和人读的名字是一样的。</li>
<li>一些字段类中有写必需的参数，例如<strong>CharField</strong>，我们必须给它指定一个最大长度<strong>(max_length)</strong>。它不仅仅需要数据库模式，还需要验证的，后面我们就会将到。</li>
<li>一个字段还可以有多个可选的参数，譬如，我们把vote的默认值设为0.</li>
<li>最后，要定义一个关系，用<strong>ForeignKey</strong>，即是外键。它向Django表明每个<strong>Choice</strong>关联一个<strong>Question</strong>。Django支持多种数据库映射关系：多对一，多对多，一对一。</li>
</ul>
<h2 id="激活模型(Activating_models)">激活模型(Activating models)</h2>
<ul>
<li>上面一小段代码给了Django很多的信息。通过代码，Django可以做到：<ul>
<li>为这个app创建一个数据库模式(<strong>CREATE TABLE 语句</strong>)</li>
<li>创建一个Python数据库可用API，用于使用<strong>Question</strong>和<strong>Choice</strong>对象。</li>
</ul>
</li>
<li><p>但是我们先要告知项目polls已经安装了。</p>
<blockquote>
<p><strong>哲学</strong><br>Django的app是可插的(像USB一样，适配多台电脑)：你的app可以插入到多个项目当中，你也可以发布app，这样它(app)就不用绑定到Django中用于安装了。</p>
</blockquote>
</li>
<li><p>再一次编辑<strong>mysite/settings.py</strong>文件，然后修改<strong>INSTALLED_APPS</strong>的内容，让它包含’<strong>polls</strong>‘，修改后的文件是：</p>
</li>
<li><font color="green">mysite/settings.py</font>

</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">INSTALLED_APPS = (</div><div class="line">    <span class="string">'django.contrib.admin'</span>,</div><div class="line">    <span class="string">'django.contrib.auth'</span>,</div><div class="line">    <span class="string">'django.contrib.contenttypes'</span>,</div><div class="line">    <span class="string">'django.contrib.sessions'</span>,</div><div class="line">    <span class="string">'django.contrib.messages'</span>,</div><div class="line">    <span class="string">'django.contrib.staticfiles'</span>,</div><div class="line">    <span class="string">'polls'</span>,</div><div class="line">)</div></pre></td></tr></table></figure>

<ul>
<li>现在Django知道应该包含polls这个app了。让我们运行另外一个命令：</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ python manage.py makemigrations polls</div></pre></td></tr></table></figure>

<ul>
<li>你应该看到以下的输出：</li>
</ul>
<figure class="highlight echo"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Migrations <span class="keyword">for</span> <span class="string">'polls'</span>:</div><div class="line">  <span class="number">0001</span>_initial.py:</div><div class="line">    - <span class="keyword">Create</span> model Choice</div><div class="line">    - <span class="keyword">Create</span> model Question</div><div class="line">    - <span class="keyword">Add</span> field question <span class="keyword">to</span> choice</div></pre></td></tr></table></figure>

<ul>
<li>通过<strong>makemigrations</strong>口令，你在告诉Django你的模型有了修改(这样，你就新建了一个模型)，你希望修改转存的过程当成迁移。</li>
<li>Migrations记录着你对模型做了什么修改(也即是数据库模式)-它们只是硬盘上的文件。你可以读取你新模型的migration如果你喜欢，它保存在<strong>polls/migrations/0001_initial.py</strong>文件当中。不要担心，你不需要每当Django创建一个的时候就读取一次，但它还是可编辑的，当你想对它进行修改的时候。</li>
<li>有一个口令可以帮你运行migration并且自动管理你的数据库模式，它是<strong>migrate</strong>，我们就要将到它了，但首先，让我们看一下migration会运行什么样的SQL代码。<strong>sqlmigrate</strong>口令得到migration的名字并且返回它们的SQL。</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ python manage.py sqlmigrate polls <span class="number">0001</span></div></pre></td></tr></table></figure>

<ul>
<li>你应该会看到以下相似的代码：(我们已经把代码格式化了，为了让我们更易读懂它)</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="operator"><span class="keyword">BEGIN</span>;</span></div><div class="line"><span class="operator"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> polls_question (</span></div><div class="line">    <span class="string">"id"</span> <span class="built_in">serial</span> <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">PRIMARY</span> <span class="keyword">KEY</span>,</div><div class="line">    <span class="string">"question_text"</span> <span class="built_in">varchar</span>(<span class="number">200</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</div><div class="line">    <span class="string">"pub_date"</span> <span class="keyword">timestamp</span> <span class="keyword">with</span> <span class="keyword">time</span> zone <span class="keyword">NOT</span> <span class="literal">NULL</span></div><div class="line">);</div><div class="line"></div><div class="line"><span class="operator"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> polls_choice (</span></div><div class="line">    <span class="string">"id"</span> <span class="built_in">serial</span> <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">PRIMARY</span> <span class="keyword">KEY</span>,</div><div class="line">    <span class="string">"question_id"</span> <span class="built_in">integer</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</div><div class="line">    <span class="string">"choice_text"</span> <span class="built_in">varchar</span>(<span class="number">200</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</div><div class="line">    <span class="string">"votes"</span> <span class="built_in">integer</span> <span class="keyword">NOT</span> <span class="literal">NULL</span></div><div class="line">);</div><div class="line"></div><div class="line"><span class="operator"><span class="keyword">CREATE</span> <span class="keyword">INDEX</span> polls_choice_7aa0f6ee <span class="keyword">ON</span> <span class="string">"polls_choice"</span> (<span class="string">"question_id"</span>);</span></div><div class="line"></div><div class="line"><span class="operator"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> <span class="string">"polls_choice"</span></span></div><div class="line">  <span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> polls_choice_question_id_246c99a640fbbd72_fk_polls_question_id</div><div class="line">    <span class="keyword">FOREIGN</span> <span class="keyword">KEY</span> (<span class="string">"question_id"</span>)</div><div class="line">    <span class="keyword">REFERENCES</span> <span class="string">"polls_question"</span> (<span class="string">"id"</span>)</div><div class="line">    <span class="keyword">DEFERRABLE</span> <span class="keyword">INITIALLY</span> <span class="keyword">DEFERRED</span>;</div><div class="line"><span class="operator"><span class="keyword">COMMIT</span>;</span></div></pre></td></tr></table></figure>

<ul>
<li><p>注意一下内容：</p>
<ul>
<li>确切的输出会和你用的数据库而有所不同。上面的例子是用PostgreSQL生成的。</li>
<li>表名是自动取app的名字加上模型的名字(小写格式)，如polls_question和polls_choice。(你可以自己更改)</li>
<li>主见(IDs)是自增长的，你也可以自行修改。</li>
<li>按照惯例，Django会在外键字段名字后面加上<strong>_id</strong>,(当然这个你也可以修改)。</li>
<li>外键关系是通过<strong>FOREIGN KEY</strong>这个约束来清晰定义的。不要担心不同的部分，它仅仅是告知PostgreSQL在结束事务之前不要强行实施外键。</li>
<li>它是根据你用的数据库来适配的，所以数据库指定的域类型，好像，自动适配<strong>auto_increment</strong>(MySQL),<strong>serial</strong>(PostgreSQL)，或者<strong>integer primary key autoincrement</strong>(SQLite)，给字段名加引号是一样的，加单引号或双引号。</li>
<li><strong>sqlmigrate</strong>口令并不会真正在你的数据库上运行migtaration-只是把它打印到屏幕上，让你知道Django需要什么SQL。知道Django正在做什么或者你拥有可以修改SQL资格的数据库管理员是非常有用的。</li>
</ul>
</li>
<li><p>如果你有兴趣，你也可以运行<strong>python manage.py check</strong>口令，它会检测你的项目是否有问题或者创建数据库是否顺利。</p>
</li>
<li>现在，再次运行<strong>migrate</strong>来创建你数据库上的模型：</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">Operations to perform:</div><div class="line">  Apply all migrations: admin, contenttypes, polls, auth, sessions</div><div class="line">Running migrations:</div><div class="line">  Applying polls<span class="number">.0001</span>_initial... OK</div></pre></td></tr></table></figure>

<ul>
<li><strong>migrate</strong>口令处理所有那些没被处理的migrations。(Django通过你数据库当中的特殊表<strong>django_migrations</strong>来跟踪那些被处理了或者那些没有处理)</li>
<li><strong>migrations</strong>非常强大，而且当你在开发你的项目时，它可以让你随着时间变化修改你的模型，而不需要删除当前的数据库去创建一个新的。我们稍后再对这部分做深入研究，现在，请记住以下三步来对你的模型进行修改：<ul>
<li>修改模型(在<strong>models.py</strong>文件中)</li>
<li>运行<strong>python manage.py makemigrations</strong>来为这些修改创建migrations</li>
<li>运行<strong>python manage.py migrate</strong>把这些修改应用(apply)到数据库</li>
</ul>
</li>
<li>为什么make和apply这两步要分开执行呢？原因是你要首先提交migrations到你的版本控制系统，然后在把它们和你的app一起执行。这样会不仅会令你的开发更容易，还便于其他的开发者使用和再次开发。</li>
<li>阅读<a href="https://docs.djangoproject.com/en/1.7/ref/django-admin/" target="_blank" rel="external">django-admin.py documentation</a>得到<strong>manage.py</strong>工具类的更详细的信息。</li>
</ul>
<h2 id="玩转API">玩转API</h2>
<ul>
<li>现在，让我们投进可交互的Python shell，玩一下Django提供给我们的免费的API。进入Python Shell，用这个命令：</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ python manage.py shell</div></pre></td></tr></table></figure>

<ul>
<li>我们用python manage.py而不用python的原因是<strong>manage.py</strong>设置了<strong>DJANGO_SETTINGS_MODULE</strong>的环境变量，也就是说，Django和python的路径都加入了你的<strong>mysite/settings.py</strong>文件中。</li>
</ul>
<blockquote>
<p><strong>跳过manage.py(Bypassing manage.py)</strong><br>如果你不想使用<strong>manage.py</strong>，没问题，只需要把<strong>DJANGO_SETTINGS_MODULE</strong>的环境变量设置到<strong>mysite.settings</strong>中，新开一个纯净的Python shell，然后设置Django：</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="prompt">&gt;&gt;&gt; </span><span class="keyword">import</span> django</div><div class="line"><span class="prompt">&gt;&gt;&gt; </span>django.setup()</div></pre></td></tr></table></figure>

<blockquote>
<p>如果这样报了一个<strong>AttributeError</strong>错误，那么你现在使用的是一个不匹配的Django版本。请更换不同的Django版本。<br>你必须在manage.py的目录下运行<strong>python</strong>，或者确保你的目录加入了Python路径，这样<strong>import mysite</strong>才起作用。<br>更多详情，请看<a href="https://docs.djangoproject.com/en/1.7/ref/django-admin/" target="_blank" rel="external">django-admin.py documentation</a></p>
</blockquote>
<ul>
<li>当你进入了shell，可以探索<a href="database API:">database API</a></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">In [<span class="number">1</span>]: <span class="keyword">from</span> polls.models <span class="keyword">import</span> Question, Choice <span class="comment"># Import the model classes we just wrote</span></div><div class="line"><span class="comment"># No questions are in the system yet.</span></div><div class="line">In [<span class="number">2</span>]: Question.objects.all()</div><div class="line">Out[<span class="number">2</span>]: []</div><div class="line"></div><div class="line"><span class="comment"># Create a new Question.</span></div><div class="line"><span class="comment"># Support for time zones is enabled in the default settings file, so Django experts a datatime with tzinfo for </span></div><div class="line"><span class="comment"># pub_date.Use timezone.now()</span></div><div class="line"><span class="comment"># Instead of datatime.datetime.now() and it will do the right thing. </span></div><div class="line">In [<span class="number">3</span>]: <span class="keyword">from</span> django.utils <span class="keyword">import</span> timezone</div><div class="line"></div><div class="line">In [<span class="number">4</span>]: q = Question(question_text=<span class="string">"What's new?"</span>, pub_date = timezone.now())</div><div class="line"></div><div class="line"><span class="comment"># Save the object into the database. You have to call save() explicitly.</span></div><div class="line">In [<span class="number">5</span>]: q.save()</div><div class="line"></div><div class="line"><span class="comment"># Now it has an ID. Note that this might say "1L" instead of "1", depending on which database you're using. That's no biggie; </span></div><div class="line"><span class="comment"># it just means your database backend prefers to returns to return integers as Python long integer objects.</span></div><div class="line">In [<span class="number">6</span>]: q.id</div><div class="line">Out[<span class="number">6</span>]: <span class="number">1</span></div><div class="line"></div><div class="line"><span class="comment"># Access model field values via Python attributes.</span></div><div class="line">In [<span class="number">7</span>]: q.question_text</div><div class="line">Out[<span class="number">7</span>]: <span class="string">"What's new?"</span></div><div class="line"></div><div class="line">In [<span class="number">8</span>]: q.pub_date</div><div class="line">Out[<span class="number">8</span>]: datetime.datetime(<span class="number">2015</span>, <span class="number">1</span>, <span class="number">18</span>, <span class="number">2</span>, <span class="number">22</span>, <span class="number">53</span>, <span class="number">431000</span>, tzinfo=&lt;UTC&gt;)</div><div class="line"></div><div class="line"><span class="comment"># Change values by changing the attributes, then calling save().</span></div><div class="line">In [<span class="number">9</span>]: q.question_text = <span class="string">"What's up?"</span></div><div class="line"></div><div class="line">In [<span class="number">10</span>]: q.save()</div><div class="line"></div><div class="line"><span class="comment"># objects.all() displays all the questions in the database.</span></div><div class="line">In [<span class="number">11</span>]: Question.objects.all()</div><div class="line">Out[<span class="number">11</span>]: [&lt;Question: Question object&gt;]</div></pre></td></tr></table></figure>

<ul>
<li>等一下，<strong><question: question="" object=""></question:></strong>似乎对这个对象来说表现很差。我们可以这样来修正它，修改<strong>Question</strong>模型(在<strong>polls/models.py</strong>文件中)，为<strong>Question</strong>和<strong>Choice</strong>分别添加一个<strong><strong>unicode</strong></strong>方法(就像java中重写toString()方法一样)。</li>
<li><font color="green">polls/models.py</font>

</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> django.db <span class="keyword">import</span> models</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Question</span><span class="params">(models.Model)</span>:</span></div><div class="line">    <span class="comment"># ...</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__unicode__</span><span class="params">(self)</span>:</span>              <span class="comment"># __str__ on Python 3</span></div><div class="line">        <span class="keyword">return</span> self.question_text</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Choice</span><span class="params">(models.Model)</span>:</span></div><div class="line">    <span class="comment"># ...</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__unicode__</span><span class="params">(self)</span>:</span>              <span class="comment"># __str__ on Python 3</span></div><div class="line">        <span class="keyword">return</span> self.choice_text</div></pre></td></tr></table></figure>

<ul>
<li><p>为你的模型添加<strong>unicode</strong>()方法非常重要，不仅仅方便于你和Python进行交互，还方便通过Django自动生成的管理员对对象的展现。</p>
<blockquote>
<p><strong><strong>str</strong>()方法还是<strong>unicode</strong>()方法</strong><br>在Python 3，就简单的用<strong><strong>str</strong>()</strong>方法<br>在Python 2中，你应该定义<strong><strong>unicode</strong>()</strong>方法返回的是<strong>unicode</strong>值。Django模型有一个默认的<strong><strong>str</strong>()</strong>方法，它调用了<strong><strong>unicode</strong>()</strong>方法并且把结果转化成了一个UTF-8字节型字符串。也就是说<strong><strong>unicode</strong>(p)</strong>方法返回的是一个Unicode字符串，而<strong>str(p)</strong>返回的是一个字节型的字符串，编码格式是UTF-8。Python刚好相反：<strong>object</strong>有一个<strong><strong>unicode</strong>()</strong>方法，它调用了<strong><strong>str</strong>()</strong>方法，并把结果解释成一个ASCII的字节型的字符串。这些不同很容易混淆。<br>如果你觉得以上内容很混乱，那请直接用Python 3吧。</p>
</blockquote>
</li>
<li><p>看完了一般的Python方法，让我们添加一个自定义的方法，说明一下：</p>
</li>
<li><font color="green">polls/models.py</font>

</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> datetime</div><div class="line"></div><div class="line"><span class="keyword">from</span> django.db <span class="keyword">import</span> models</div><div class="line"><span class="keyword">from</span> django.utils <span class="keyword">import</span> timezone</div><div class="line"></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Question</span><span class="params">(models.Model)</span>:</span></div><div class="line">    <span class="comment"># ...</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">was_published_recently</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="keyword">return</span> self.pub_date &gt;= timezone.now() - datetime.timedelta(days=<span class="number">1</span>)</div></pre></td></tr></table></figure>

<ul>
<li>注意到加入了<strong>import datetime</strong>和<strong>from django.utils import timezone</strong>，请参考Python的标准<strong>datetime</strong>模型和从<strong>django.utils.timezone</strong>中了解到Django相关的时区工具类。如果你还没熟悉控制Python中的时区，你可以参考这里<a href="https://docs.djangoproject.com/en/1.7/topics/i18n/timezones/" target="_blank" rel="external">time zone support docs</a>。</li>
<li>保存修改后，通过<strong>python manage.py shell</strong>打开一个新的Python shell交互:</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div></pre></td><td class="code"><pre><div class="line">&gt;&gt;&gt; from polls.models import Question, Choice</div><div class="line"></div><div class="line"># Make sure our __str__() addition worked.</div><div class="line">&gt;&gt;&gt; Question.objects.all()</div><div class="line">[&lt;Question: What's up?&gt;]</div><div class="line"></div><div class="line"># Django provides a rich database lookup API that's entirely driven by</div><div class="line"># keyword arguments.</div><div class="line">&gt;&gt;&gt; Question.objects.filter(id=1)</div><div class="line">[&lt;Question: What's up?&gt;]</div><div class="line">&gt;&gt;&gt; Question.objects.filter(question_text__startswith='What')</div><div class="line">[&lt;Question: What's up?&gt;]</div><div class="line"></div><div class="line"># Get the question that was published this year.</div><div class="line">&gt;&gt;&gt; from django.utils import timezone</div><div class="line">&gt;&gt;&gt; current_year = timezone.now().year</div><div class="line">&gt;&gt;&gt; Question.objects.get(pub_date__year=current_year)</div><div class="line">&lt;Question: What's up?&gt;</div><div class="line"></div><div class="line"># Request an ID that doesn't exist, this will raise an exception.</div><div class="line">&gt;&gt;&gt; Question.objects.get(id=2)</div><div class="line">Traceback (most recent call last):</div><div class="line">    ...</div><div class="line">DoesNotExist: Question matching query does not exist.</div><div class="line"></div><div class="line"># Lookup by a primary key is the most common case, so Django provides a</div><div class="line"># shortcut for primary-key exact lookups.</div><div class="line"># The following is identical to Question.objects.get(id=1).</div><div class="line">&gt;&gt;&gt; Question.objects.get(pk=1)</div><div class="line">&lt;Question: What's up?&gt;</div><div class="line"></div><div class="line"># Make sure our custom method worked.</div><div class="line">&gt;&gt;&gt; q = Question.objects.get(pk=1)</div><div class="line">&gt;&gt;&gt; q.was_published_recently()</div><div class="line">True</div><div class="line"></div><div class="line"># Give the Question a couple of Choices. The create call constructs a new</div><div class="line"># Choice object, does the INSERT statement, adds the choice to the set</div><div class="line"># of available choices and returns the new Choice object. Django creates</div><div class="line"># a set to hold the "other side" of a ForeignKey relation</div><div class="line"># (e.g. a question's choice) which can be accessed via the API.</div><div class="line">&gt;&gt;&gt; q = Question.objects.get(pk=1)</div><div class="line"></div><div class="line"># Display any choices from the related object set -- none so far.</div><div class="line">&gt;&gt;&gt; q.choice_set.all()</div><div class="line">[]</div><div class="line"></div><div class="line"># Create three choices.</div><div class="line">&gt;&gt;&gt; q.choice_set.create(choice_text='Not much', votes=0)</div><div class="line">&lt;Choice: Not much&gt;</div><div class="line">&gt;&gt;&gt; q.choice_set.create(choice_text='The sky', votes=0)</div><div class="line">&lt;Choice: The sky&gt;</div><div class="line">&gt;&gt;&gt; c = q.choice_set.create(choice_text='Just hacking again', votes=0)</div><div class="line"></div><div class="line"># Choice objects have API access to their related Question objects.</div><div class="line">&gt;&gt;&gt; c.question</div><div class="line">&lt;Question: What's up?&gt;</div><div class="line"></div><div class="line"># And vice versa: Question objects get access to Choice objects.</div><div class="line">&gt;&gt;&gt; q.choice_set.all()</div><div class="line">[&lt;Choice: Not much&gt;, &lt;Choice: The sky&gt;, &lt;Choice: Just hacking again&gt;]</div><div class="line">&gt;&gt;&gt; q.choice_set.count()</div><div class="line">3</div><div class="line"></div><div class="line"># The API automatically follows relationships as far as you need.</div><div class="line"># Use double underscores to separate relationships.</div><div class="line"># This works as many levels deep as you want; there's no limit.</div><div class="line"># Find all Choices for any question whose pub_date is in this year</div><div class="line"># (reusing the 'current_year' variable we created above).</div><div class="line">&gt;&gt;&gt; Choice.objects.filter(question__pub_date__year=current_year)</div><div class="line">[&lt;Choice: Not much&gt;, &lt;Choice: The sky&gt;, &lt;Choice: Just hacking again&gt;]</div><div class="line"></div><div class="line"># Let's delete one of the choices. Use delete() for that.</div><div class="line">&gt;&gt;&gt; c = q.choice_set.filter(choice_text__startswith='Just hacking')</div><div class="line">&gt;&gt;&gt; c.delete()</div></pre></td></tr></table></figure>

<ul>
<li>关于更多信息，请看</li>
<li><a href="Accessing related objects">Accessing related objects</a>,</li>
<li><a href="https://docs.djangoproject.com/en/1.7/topics/db/queries/#field-lookups-intro" target="_blank" rel="external">Field lookups</a>,</li>
<li><a href="https://docs.djangoproject.com/en/1.7/topics/db/queries/" target="_blank" rel="external">Database API reference</a>.</li>
<li>如果你熟悉了API，那么请读下一篇<a href="">Part2-Django’s automatic admin working</a>.</li>
</ul>
  
	</div>
		<footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/Django/">Django</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/Django-Models/">Django-Models</a>
  </div>

</div>


<div class="article-share" id="share">

<div class="share-jiathis">
  
<div class="jiathis_style_24x24">
	<a class="jiathis_button_tsina"></a>
	<a class="jiathis_button_weixin"></a>
	<a class="jiathis_button_renren"></a>
	<a class="jiathis_button_qzone"></a>
	<a class="jiathis_button_googleplus"></a>
	<a class="jiathis_button_douban"></a>
	<a href="http://www.jiathis.com/share" class="jiathis jiathis_txt jtico jtico_jiathis" target="_blank"></a>
	<a class="jiathis_counter_style"></a>
</div>
<script type="text/javascript" >
    var jiathis_config={
    data_track_clickback:true,
    sm:"copy,renren,cqq",
    pic:"",
    summary:"",
     ralateuid:{"tsina":"2155417625"},hideMore:false}
    
  </script> 
<script type="text/javascript" src="//v3.jiathis.com/code/jia.js?uid=
" charset="utf-8"></script>      

 </div>

</div>
</footer>   	       
	</article>
	
<nav class="article-nav clearfix">
 
 <div class="prev" >
 <a href="/2015/01/19/Django-1-7-3-Tutorial-Part-2-管理站点/" title="Django-1-7-3-Tutorial-Part-2-管理站点">
  <strong>上一篇：</strong><br/>
  <span>
  Django-1-7-3-Tutorial-Part-2-管理站点</span>
</a>
</div>


<div class="next">
<a href="/2015/01/16/Django-1-7-3-Tutorial/"  title="Django-1.7.3-Tutorial">
 <strong>下一篇：</strong><br/> 
 <span>Django-1.7.3-Tutorial
</span>
</a>
</div>

</nav>

	
<section class="comment">
	<div class="ds-thread"></div>
	<script type="text/javascript">
	var duoshuoQuery = {short_name:"tim4chan"};
		(function() {
			var ds = document.createElement('script');
			ds.type = 'text/javascript';ds.async = true;
			ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
			ds.charset = 'UTF-8';
			(document.getElementsByTagName('head')[0] 
			 || document.getElementsByTagName('body')[0]).appendChild(ds);
		})();
		</script>
</section>


</div>  
      <div class="openaside"><a class="navbutton" href="#" title="Show Sidebar"></a></div>

  <div id="toc" class="toc-aside">
  <strong class="toc-title">Contents</strong>
 
 <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#创建你的第一个Django_app-Part_1"><span class="toc-number">1.</span> <span class="toc-text">创建你的第一个Django app-Part 1</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#创建项目"><span class="toc-number">1.1.</span> <span class="toc-text">创建项目</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#数据库配置"><span class="toc-number">1.2.</span> <span class="toc-text">数据库配置</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#发布到服务器"><span class="toc-number">1.3.</span> <span class="toc-text">发布到服务器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#创建模型(models)"><span class="toc-number">1.4.</span> <span class="toc-text">创建模型(models)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#激活模型(Activating_models)"><span class="toc-number">1.5.</span> <span class="toc-text">激活模型(Activating models)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#玩转API"><span class="toc-number">1.6.</span> <span class="toc-text">玩转API</span></a></li></ol></li></ol>
 
  </div>

<div id="asidepart">
<div class="closeaside"><a class="closebutton" href="#" title="Hide Sidebar"></a></div>
<aside class="clearfix">

  
<div class="categorieslist">
	<p class="asidetitle">Categories</p>
		<ul>
		
			<li><a href="/categories/Django/" title="Django">Django<sup>1</sup></a></li>
		
			<li><a href="/categories/JSP-Review/" title="JSP_Review">JSP_Review<sup>10</sup></a></li>
		
			<li><a href="/categories/Python笔记/" title="Python笔记">Python笔记<sup>1</sup></a></li>
		
			<li><a href="/categories/R-Tutorial/" title="R Tutorial">R Tutorial<sup>4</sup></a></li>
		
			<li><a href="/categories/probability-theory-basic-conception/" title="probability-theory-basic-conception">probability-theory-basic-conception<sup>1</sup></a></li>
		
			<li><a href="/categories/医学图像处理/" title="医学图像处理">医学图像处理<sup>2</sup></a></li>
		
			<li><a href="/categories/原型设计/" title="原型设计">原型设计<sup>1</sup></a></li>
		
			<li><a href="/categories/备忘/" title="备忘">备忘<sup>1</sup></a></li>
		
			<li><a href="/categories/技术开发/" title="技术开发">技术开发<sup>1</sup></a></li>
		
			<li><a href="/categories/数据挖掘与R语言-案例学习/" title="数据挖掘与R语言-案例学习">数据挖掘与R语言-案例学习<sup>4</sup></a></li>
		
			<li><a href="/categories/数据挖掘算法总结/" title="数据挖掘算法总结">数据挖掘算法总结<sup>3</sup></a></li>
		
			<li><a href="/categories/机器学习/" title="机器学习">机器学习<sup>2</sup></a></li>
		
			<li><a href="/categories/概率论笔记/" title="概率论笔记">概率论笔记<sup>2</sup></a></li>
		
			<li><a href="/categories/毕业设计系列/" title="毕业设计系列">毕业设计系列<sup>8</sup></a></li>
		
			<li><a href="/categories/毕设系列/" title="毕设系列">毕设系列<sup>1</sup></a></li>
		
			<li><a href="/categories/算法/" title="算法">算法<sup>1</sup></a></li>
		
			<li><a href="/categories/面试分享/" title="面试分享">面试分享<sup>2</sup></a></li>
		
			<li><a href="/categories/黑马程序员/" title="黑马程序员">黑马程序员<sup>2</sup></a></li>
		
		</ul>
</div>


  
<div class="tagslist">
	<p class="asidetitle">Tags</p>
		<ul class="clearfix">
		
			<li><a href="/tags/JSP-网页开发/" title="JSP 网页开发">JSP 网页开发<sup>10</sup></a></li>
		
			<li><a href="/tags/数据挖掘/" title="数据挖掘">数据挖掘<sup>5</sup></a></li>
		
			<li><a href="/tags/R-basics/" title="R basics">R basics<sup>4</sup></a></li>
		
			<li><a href="/tags/SVM入门/" title="SVM入门">SVM入门<sup>2</sup></a></li>
		
			<li><a href="/tags/概率论/" title="概率论">概率论<sup>2</sup></a></li>
		
			<li><a href="/tags/FP-growth-tree/" title="FP-growth-tree">FP-growth-tree<sup>1</sup></a></li>
		
			<li><a href="/tags/Aprior-Algorithm/" title="Aprior Algorithm">Aprior Algorithm<sup>1</sup></a></li>
		
			<li><a href="/tags/概率论基本概念/" title="概率论基本概念">概率论基本概念<sup>1</sup></a></li>
		
			<li><a href="/tags/10大基础实用算法/" title="10大基础实用算法">10大基础实用算法<sup>1</sup></a></li>
		
			<li><a href="/tags/手写数字-SVM/" title="手写数字 SVM">手写数字 SVM<sup>1</sup></a></li>
		
			<li><a href="/tags/最小二乘法-论文翻译/" title="最小二乘法 论文翻译">最小二乘法 论文翻译<sup>1</sup></a></li>
		
			<li><a href="/tags/linux-C/" title="linux C">linux C<sup>1</sup></a></li>
		
			<li><a href="/tags/手写数字识别-Kernel-Support-Vector-Machine/" title="手写数字识别 Kernel Support Vector Machine">手写数字识别 Kernel Support Vector Machine<sup>1</sup></a></li>
		
			<li><a href="/tags/梯度下降法/" title="梯度下降法">梯度下降法<sup>1</sup></a></li>
		
			<li><a href="/tags/多线程/" title="多线程">多线程<sup>1</sup></a></li>
		
			<li><a href="/tags/单例设计模式/" title="单例设计模式">单例设计模式<sup>1</sup></a></li>
		
			<li><a href="/tags/Django-Models/" title="Django-Models">Django-Models<sup>1</sup></a></li>
		
			<li><a href="/tags/面试算法/" title="面试算法">面试算法<sup>1</sup></a></li>
		
			<li><a href="/tags/机器学习基础/" title="机器学习基础">机器学习基础<sup>1</sup></a></li>
		
			<li><a href="/tags/灰度直方图/" title="灰度直方图">灰度直方图<sup>1</sup></a></li>
		
		</ul>
</div>


  
  <div class="tagcloudlist">
    <p class="asidetitle">Tag Cloud</p>
    <div class="tagcloudlist clearfix">
       <a href="/tags/10大基础实用算法/" style="font-size: 10.00px;">10大基础实用算法</a><a href="/tags/Aprior-Algorithm/" style="font-size: 10.00px;">Aprior Algorithm</a><a href="/tags/Django-Models/" style="font-size: 10.00px;">Django-Models</a><a href="/tags/FP-growth-tree/" style="font-size: 10.00px;">FP-growth-tree</a><a href="/tags/JSP-网页开发/" style="font-size: 20.00px;">JSP 网页开发</a><a href="/tags/R-basics/" style="font-size: 15.00px;">R basics</a><a href="/tags/SVM/" style="font-size: 10.00px;">SVM</a><a href="/tags/SVM入门/" style="font-size: 12.50px;">SVM入门</a><a href="/tags/linux-C/" style="font-size: 10.00px;">linux C</a><a href="/tags/二值化/" style="font-size: 10.00px;">二值化</a><a href="/tags/单例设计模式/" style="font-size: 10.00px;">单例设计模式</a><a href="/tags/原型设计/" style="font-size: 10.00px;">原型设计</a><a href="/tags/多线程/" style="font-size: 10.00px;">多线程</a><a href="/tags/字符串操作/" style="font-size: 10.00px;">字符串操作</a><a href="/tags/序列/" style="font-size: 10.00px;">序列</a><a href="/tags/感知机/" style="font-size: 10.00px;">感知机</a><a href="/tags/手写数字-SVM/" style="font-size: 10.00px;">手写数字 SVM</a><a href="/tags/手写数字识别-Kernel-Support-Vector-Machine/" style="font-size: 10.00px;">手写数字识别 Kernel Support Vector Machine</a><a href="/tags/数据挖掘/" style="font-size: 17.50px;">数据挖掘</a><a href="/tags/最小二乘法/" style="font-size: 10.00px;">最小二乘法</a><a href="/tags/最小二乘法-论文翻译/" style="font-size: 10.00px;">最小二乘法 论文翻译</a><a href="/tags/有价值的博客记录/" style="font-size: 10.00px;">有价值的博客记录</a><a href="/tags/机器学习入门基础/" style="font-size: 10.00px;">机器学习入门基础</a><a href="/tags/机器学习基础/" style="font-size: 10.00px;">机器学习基础</a><a href="/tags/梯度下降法/" style="font-size: 10.00px;">梯度下降法</a><a href="/tags/概率论/" style="font-size: 12.50px;">概率论</a><a href="/tags/概率论基本概念/" style="font-size: 10.00px;">概率论基本概念</a><a href="/tags/正则表达式/" style="font-size: 10.00px;">正则表达式</a><a href="/tags/灰度直方图/" style="font-size: 10.00px;">灰度直方图</a><a href="/tags/面试算法/" style="font-size: 10.00px;">面试算法</a>
    </div>
  </div>


  <div class="weiboshow">
  <p class="asidetitle">Weibo</p>
<iframe width="100%" height="300" class="share_self"  frameborder="0" scrolling="no" src="http://widget.weibo.com/weiboshow/index.php?language=&width=0&height=300&fansRow=2&ptype=1&speed=300&skin=1&isTitle=1&noborder=1&isWeibo=1&isFans=0&uid=2155417625&verifier=9f994c23&dpc=1"></iframe>
</div>


  <div class="linkslist">
  <p class="asidetitle">Links</p>
    <ul>
	  <li><a href="http://zjdian.com/" target="_blank" title="zjdian">中继点</li>
      <li><a href="http://ripeconan.com/" target="_blank" title="ripeconan">Ripeconan</a></li>
      <li><a href="http://hexo.io" target="_blank" title="Hexo">Hexo</a></li>
    </ul>
</div>

  <div class="rsspart">
	<a href="/atom.xml" target="_blank" title="rss">RSS</a>
</div>

</aside>
</div>
    </div>
    <footer><div id="footer" >
	
	<div class="line">
		<span></span>
		<div class="author"></div>
	</div>
	
	
	<section class="info">
		<p> Hello, I&#39;m Tim Chan. <br/>
			Welcome to my personal blog.</p>
	</section>
	 
	<div class="social-font" class="clearfix">
		
		<a href="http://weibo.com/2155417625" target="_blank" class="icon-weibo" title="weibo"></a>
		
		
		<a href="https://github.com/chenyuqing" target="_blank" class="icon-github" title="github"></a>
		
		
		
		
		
		<a href="https://www.douban.com/people/motoleiusre" target="_blank" class="icon-douban" title="豆瓣"></a>
		
		
		
		<a href="mailto:motoleisure@gmail.com" target="_blank" class="icon-email" title="Email Me"></a>
		
	</div>
		<p class="copyright">Powered by <a href="http://hexo.io" target="_blank" title="hexo">hexo</a> and Theme by <a href="https://github.com/wuchong/jacman" target="_blank" title="Pacman">Jacman</a> © 2015 
		
		<a href="http://tim4chan.com/about" target="_blank" title="Tim Chan">Tim Chan</a>
		
		</p>
</div>
</footer>
    <script src="/js/jquery-2.0.3.min.js"></script>
<script type="text/javascript">
$(document).ready(function(){ 
  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  $(window).resize(function(){
    getSize(); 
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else
    {
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
      
      $('#toc.toc-aside').css('display', 'none');
        
    }
  });
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');      
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(80,260-$(this).scrollTop()));
  });
});
</script>

<script type="text/javascript">
$(document).ready(function(){ 
  var ai = $('.article-content>iframe'),
      ae = $('.article-content>embed'),
      t  = $('#toc'),
      h  = $('article h2')
      ah = $('article h2'),
      ta = $('#toc.toc-aside'),
      o  = $('.openaside'),
      c  = $('.closeaside');
  if(ai.length>0){
    ai.wrap('<div class="video-container" />');
  };
  if(ae.length>0){
   ae.wrap('<div class="video-container" />');
  };
  if(ah.length==0){
    t.css('display','none');
  }else{
    c.click(function(){
      ta.css('display', 'block').addClass('fadeIn');
    });
    o.click(function(){
      ta.css('display', 'none');
    });
    $(window).scroll(function(){
      ta.css("top",Math.max(140,320-$(this).scrollTop()));
    });
  };
});
</script>




<script type="text/javascript">
  var duoshuoQuery = {short_name:"乐果404"};
  (function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0] 
    || document.getElementsByTagName('body')[0]).appendChild(ds);
  })();
</script> 







<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
$(document).ready(function(){ 
  $('.article-content').each(function(i){
    $(this).find('img').each(function(){
      if ($(this).parent().hasClass('fancybox')) return;
      var alt = this.alt;
      if (alt) $(this).after('<span class="caption">' + alt + '</span>');
      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox"></a>');
    });
    $(this).find('.fancybox').each(function(){
      $(this).attr('rel', 'article' + i);
    });
  });
  if($.fancybox){
    $('.fancybox').fancybox();
  }
}); 
</script>





<div id="totop">
<a title="Back to Top"><img src="/img/scrollup.png"/></a>
</div>

<script src="/js/totop.js"></script>




  </body>
</html>


<a href="https://github.com/chenyuqing/chenyuqing.github.io"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://camo.githubusercontent.com/652c5b9acfaddf3a9c326fa6bde407b87f7be0f4/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f6f72616e67655f6666373630302e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_orange_ff7600.png"></a>